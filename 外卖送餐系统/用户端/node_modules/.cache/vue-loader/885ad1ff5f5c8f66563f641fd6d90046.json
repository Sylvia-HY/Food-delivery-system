{"remainingRequest":"E:\\项目\\2022\\082601-外卖送餐\\用户端\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\项目\\2022\\082601-外卖送餐\\用户端\\src\\views\\user\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\项目\\2022\\082601-外卖送餐\\用户端\\src\\views\\user\\index.vue","mtime":1634967165000},{"path":"E:\\项目\\2022\\082601-外卖送餐\\用户端\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1641885170445},{"path":"E:\\项目\\2022\\082601-外卖送餐\\用户端\\node_modules\\babel-loader\\lib\\index.js","mtime":1641885170443},{"path":"E:\\项目\\2022\\082601-外卖送餐\\用户端\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1641885170445},{"path":"E:\\项目\\2022\\082601-外卖送餐\\用户端\\node_modules\\vue-loader\\lib\\index.js","mtime":1642038070263}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBVcGRhdGVOYW1lIGZyb20gIi4vY29tcG9uZXRzL3VwZGF0ZS1uYW1lLnZ1ZSI7CmltcG9ydCBVcGRhdGVQd2QgZnJvbSAiLi9jb21wb25ldHMvdXBkYXRlLXB3ZC52dWUiOwppbXBvcnQgVXBkYXRlR2VuZGVyIGZyb20gIi4vY29tcG9uZXRzL3VwZGF0ZS1nZW5kZXIudnVlIjsKaW1wb3J0IFVwZGF0ZUJpcnRoZGF5IGZyb20gIi4vY29tcG9uZXRzL3VwZGF0ZS1iaXJ0aGRheS52dWUiOwppbXBvcnQgYXhpb3MgZnJvbSAiYXhpb3MiOwppbXBvcnQgKiBhcyBhcGkgZnJvbSAiQC9hcGkvYXBpIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiVXNlclByb2ZpbGUiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB1c2VyOiB7CiAgICAgICAgaW1nOiAiIiwKICAgICAgICBuYW1lOiAiIiwKICAgICAgICBzZXg6ICLnlLciLAogICAgICAgIGJpcnRoZGF5OiAiIiwKICAgICAgICBwd2Q6ICIiCiAgICAgIH0sCiAgICAgIGlzRWRpdE5hbWVTaG93OiBmYWxzZSwKICAgICAgaXNFZGl0UHdkU2hvdzogZmFsc2UsCiAgICAgIGlzRWRpdEdlbmRlclNob3c6IGZhbHNlLAogICAgICBpc0VkaXRCaXJ0aGRheVNob3c6IGZhbHNlLAogICAgICB1cmw6IHByb2Nlc3MuZW52LlZVRV9BUFBfQkFTRV9GSUxFCiAgICB9OwogIH0sCiAgY29tcG9uZW50czogewogICAgVXBkYXRlTmFtZSwKICAgIFVwZGF0ZVB3ZCwKICAgIFVwZGF0ZUdlbmRlciwKICAgIFVwZGF0ZUJpcnRoZGF5CiAgfSwKICBjb21wdXRlZDoge30sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMudXNlci5uYW1lID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgibmFtZSIpOwogICAgdGhpcy51c2VyLmltZyA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImltZyIpOwogICAgdGhpcy51c2VyLnNleCA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oInNleCIpOwogICAgdGhpcy51c2VyLmJpcnRoZGF5ID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgiYmlydGhkYXkiKTsKICAgIHRoaXMudXNlci5wd2QgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJwd2QiKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8v5LiK5Lyg5aS05YOPCiAgICBvbkZpbGVDaGFuZ2UoKSB7CiAgICAgIGxldCBkYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgIGRhdGEuYXBwZW5kKCJmaWxlIiwgdGhpcy4kcmVmcy5maWxlLmZpbGVzWzBdKTsKCiAgICAgIGF4aW9zLnBvc3QodGhpcy51cmwsIGRhdGEpLnRoZW4oKHJlcykgPT4gewogICAgICAgIHRoaXMudXNlci5pbWcgPSByZXMuZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCgogICAgLy8g5L+d5a2YCiAgICBzYXZlKCkgewogICAgICBpZiAodGhpcy51c2VyLm5hbWUgPT0gIiIpIHsKICAgICAgICB0aGlzLiR0b2FzdCgi6K+36L6T5YWl5pi156ewIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoIS9eW0EtWmEtejAtOV17OCwxMn0kLy50ZXN0KHRoaXMudXNlci5wd2QpKSB7CiAgICAgICAgdGhpcy4kdG9hc3QoIuWvhueggeS4ujh+MTLkvY3mlbDlrZflrZfmr43nu4TlkIgiKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGFwaQogICAgICAgIC51c2Vyc2F2ZSh7CiAgICAgICAgICAuLi50aGlzLnVzZXIsCiAgICAgICAgICBpZDogc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgiaWQiKQogICAgICAgIH0pCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgaWYgKHJlcy5jb2RlID09IDIwMCkgewogICAgICAgICAgICB0aGlzLiR0b2FzdCgi5L+d5a2Y5oiQ5YqfISIpOwogICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCJuYW1lIiwgdGhpcy51c2VyLm5hbWUpOwogICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCJpbWciLCB0aGlzLnVzZXIuaW1nKTsKICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgic2V4IiwgdGhpcy51c2VyLnNleCk7CiAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oImJpcnRoZGF5IiwgdGhpcy51c2VyLmJpcnRoZGF5KTsKICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgicHdkIiwgdGhpcy51c2VyLnB3ZCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\n  <div class=\"user-profile\">\n    <div class=\"commodity-head\">\n      <van-nav-bar left-arrow @click-left=\"$router.back()\" title=\"个人信息\" />\n    </div>\n    <input type=\"file\" hidden ref=\"file\" accept=\"image/*\" @change=\"onFileChange\" />\n    <van-cell class=\"user-details\" title=\"头像\" is-link center @click=\"$refs.file.click()\">\n      <van-image round fit=\"cover\" width=\"45\" height=\"45\" :src=\"user.img\" style=\"margin-top: 25px\" />\n    </van-cell>\n    <van-cell class=\"user-details\" title=\"昵称\" is-link :value=\"user.name\" @click=\"isEditNameShow = true\"></van-cell>\n    <van-cell class=\"user-details\" title=\"密码\" is-link @click=\"isEditPwdShow = true\"></van-cell>\n    <van-cell class=\"user-details\" title=\"性别\" is-link :value=\"user.sex\" @click=\"isEditGenderShow = true\"></van-cell>\n    <van-cell class=\"user-details\" title=\"生日\" is-link :value=\"user.birthday\" @click=\"isEditBirthdayShow = true\"></van-cell>\n    <div class=\"f-r f-a-c f-j-c\">\n      <van-button style=\"width: 200px; margin-top: 200px\" round color=\"#66a188\" @click=\"save\">保存</van-button>\n    </div>\n    <!-- 修改昵称 -->\n    <van-popup v-model=\"isEditNameShow\" position=\"bottom\" :style=\"{ height: '100%' }\">\n      <update-name\n        @close=\"isEditNameShow = false\"\n        :name.async=\"user.name\"\n        @onConfirm=\"\n          (name) => {\n            user.name = name;\n          }\n        \"\n      ></update-name>\n    </van-popup>\n    <!-- 修改密码 -->\n    <van-popup v-model=\"isEditPwdShow\" position=\"bottom\" :style=\"{ height: '100%' }\">\n      <update-pwd\n        @close=\"isEditPwdShow = false\"\n        :pwd.async=\"user.pwd\"\n        @onConfirm=\"\n          (pwd) => {\n            user.pwd = pwd;\n          }\n        \"\n      ></update-pwd>\n    </van-popup>\n    <!-- 修改性别 -->\n    <van-popup v-model=\"isEditGenderShow\" position=\"bottom\">\n      <!-- <update-name @close=\"isEditGenderShow = false\" :name=\"user.name\"></update-name> -->\n      <update-gender\n        :sex=\"user.sex == '男' ? 0 : 1\"\n        @close=\"isEditGenderShow = false\"\n        @onConfirm=\"\n          (sex) => {\n            user.sex = sex;\n            isEditGenderShow = false;\n          }\n        \"\n      ></update-gender>\n    </van-popup>\n    <!-- 修改生日 -->\n    <van-popup v-model=\"isEditBirthdayShow\" position=\"bottom\">\n      <!-- <update-name @close=\"isEditGenderShow = false\" :name=\"user.name\"></update-name> -->\n      <update-birthday\n        v-model=\"user.birthday\"\n        @close=\"isEditBirthdayShow = false\"\n        @onConfirm=\"\n          (birthday) => {\n            user.birthday = birthday;\n            isEditBirthdayShow = false;\n          }\n        \"\n      ></update-birthday>\n    </van-popup>\n  </div>\n</template>\n\n<script>\nimport UpdateName from \"./componets/update-name.vue\";\nimport UpdatePwd from \"./componets/update-pwd.vue\";\nimport UpdateGender from \"./componets/update-gender.vue\";\nimport UpdateBirthday from \"./componets/update-birthday.vue\";\nimport axios from \"axios\";\nimport * as api from \"@/api/api\";\n\nexport default {\n  name: \"UserProfile\",\n  data() {\n    return {\n      user: {\n        img: \"\",\n        name: \"\",\n        sex: \"男\",\n        birthday: \"\",\n        pwd: \"\"\n      },\n      isEditNameShow: false,\n      isEditPwdShow: false,\n      isEditGenderShow: false,\n      isEditBirthdayShow: false,\n      url: process.env.VUE_APP_BASE_FILE\n    };\n  },\n  components: {\n    UpdateName,\n    UpdatePwd,\n    UpdateGender,\n    UpdateBirthday\n  },\n  computed: {},\n  created() {\n    this.user.name = sessionStorage.getItem(\"name\");\n    this.user.img = sessionStorage.getItem(\"img\");\n    this.user.sex = sessionStorage.getItem(\"sex\");\n    this.user.birthday = sessionStorage.getItem(\"birthday\");\n    this.user.pwd = sessionStorage.getItem(\"pwd\");\n  },\n  methods: {\n    //上传头像\n    onFileChange() {\n      let data = new FormData();\n      data.append(\"file\", this.$refs.file.files[0]);\n\n      axios.post(this.url, data).then((res) => {\n        this.user.img = res.data.data;\n      });\n    },\n\n    // 保存\n    save() {\n      if (this.user.name == \"\") {\n        this.$toast(\"请输入昵称\");\n        return;\n      }\n\n      if (!/^[A-Za-z0-9]{8,12}$/.test(this.user.pwd)) {\n        this.$toast(\"密码为8~12位数字字母组合\");\n        return;\n      }\n\n      api\n        .usersave({\n          ...this.user,\n          id: sessionStorage.getItem(\"id\")\n        })\n        .then((res) => {\n          if (res.code == 200) {\n            this.$toast(\"保存成功!\");\n            sessionStorage.setItem(\"name\", this.user.name);\n            sessionStorage.setItem(\"img\", this.user.img);\n            sessionStorage.setItem(\"sex\", this.user.sex);\n            sessionStorage.setItem(\"birthday\", this.user.birthday);\n            sessionStorage.setItem(\"pwd\", this.user.pwd);\n          }\n        });\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n* {\n  padding: 0;\n  margin: 0;\n}\n.commodity-head /deep/ .van-nav-bar__content {\n  background-color: rgb(102, 161, 136);\n  height: 60px;\n  line-height: 60px;\n}\n.commodity-head /deep/ .van-nav-bar__title {\n  font-size: 20px;\n  font-weight: 600;\n}\n.commodity-head /deep/ .van-icon-arrow-left::before {\n  font-size: 20px;\n  font-weight: 600;\n  //   margin-top: -160px;\n  color: #000;\n}\n.user-details {\n  height: 60px;\n  line-height: 60px;\n  padding: 0 20px;\n  font-size: 18px;\n  // font-weight: 600;\n}\n.user-details /deep/ .van-icon-arrow::before {\n  margin-top: 18px;\n  color: rgb(102, 161, 136);\n  font-weight: 600;\n  font-size: 20px;\n  padding-left: 5px;\n}\n.van-popup {\n  background-color: #f5f7f9;\n}\n</style>\n"]}]}