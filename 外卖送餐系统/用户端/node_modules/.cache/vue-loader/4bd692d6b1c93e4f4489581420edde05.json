{"remainingRequest":"C:\\Users\\lenovo\\Desktop\\082601-外卖送餐\\用户端\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\lenovo\\Desktop\\082601-外卖送餐\\用户端\\src\\views\\shoppingCart\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\lenovo\\Desktop\\082601-外卖送餐\\用户端\\src\\views\\shoppingCart\\index.vue","mtime":1661932653010},{"path":"C:\\Users\\lenovo\\Desktop\\082601-外卖送餐\\用户端\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1641885170445},{"path":"C:\\Users\\lenovo\\Desktop\\082601-外卖送餐\\用户端\\node_modules\\babel-loader\\lib\\index.js","mtime":1641885170443},{"path":"C:\\Users\\lenovo\\Desktop\\082601-外卖送餐\\用户端\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1641885170445},{"path":"C:\\Users\\lenovo\\Desktop\\082601-外卖送餐\\用户端\\node_modules\\vue-loader\\lib\\index.js","mtime":1642038070263}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAqIGFzIGFwaSBmcm9tICJAL2FwaS9hcGkiOwppbXBvcnQgY2FsY3VsYXRlIGZyb20gIkAvdXRpbHMvY2FsY3VsYXRlIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiU2hvcHBpbmdJbmRleCIsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHZhbHVlOiAiIiwKICAgICAgc2hvdzogZmFsc2UsCiAgICAgIGFjdGl2ZTogIiIsCiAgICAgIHJlcGx5Y29udGVudDogIiIsCiAgICAgIGNvZGU6ICIiLAogICAgICBzaG9wcGluZ2NhcnRMaXN0OiBbXSwKICAgIH07CiAgfSwKICBjcmVhdGVkKCkgewogICAgaWYgKCFzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJpZCIpKSB7CiAgICAgIHRoaXMuJHRvYXN0KCLor7flhYjnmbvlvZUiKTsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goIi9teSIpOwogICAgICByZXR1cm47CiAgICB9CiAgICB0aGlzLmdldERhdGEoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldERhdGEoKSB7CiAgICAgIGFwaQogICAgICAgIC5vcmRlcnNsaXN0KHsKICAgICAgICAgIGxpbWl0OiA5OTksCiAgICAgICAgICBvZmZzZXQ6IDEsCiAgICAgICAgICBjb2RlOiB0aGlzLnZhbHVlLAogICAgICAgICAgc3RhdHVzOiB0aGlzLmFjdGl2ZSwKICAgICAgICAgIHVpZDogc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgiaWQiKSwKICAgICAgICB9KQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIGxldCBsaXN0ID0gW107CiAgICAgICAgICBpZiAocmVzLmRhdGEudG90YWwgPiAwKSB7CiAgICAgICAgICAgIGxldCBhcnIgPSB7fTsKICAgICAgICAgICAgcmVzLmRhdGEubGlzdC5mb3JFYWNoKChpKSA9PiB7CiAgICAgICAgICAgICAgaWYgKCFhcnJbaS5jb2RlXSkgewogICAgICAgICAgICAgICAgYXJyW2kuY29kZV0gPSB7CiAgICAgICAgICAgICAgICAgIGlkOiBpLmlkLAogICAgICAgICAgICAgICAgICBjb2RlOiBpLmNvZGUsCiAgICAgICAgICAgICAgICAgIHNuYW1lOiBpLnNuYW1lLAogICAgICAgICAgICAgICAgICBzaW1nOiBpLnNpbWcsCiAgICAgICAgICAgICAgICAgIHNpZDogaS5zaWQsCiAgICAgICAgICAgICAgICAgIHRpbWU6IGkudGltZSwKICAgICAgICAgICAgICAgICAgZ29vZHM6IFtpXSwKICAgICAgICAgICAgICAgICAgc3RhdHVzOiBpLnN0YXR1cywKICAgICAgICAgICAgICAgICAgdHlwZTogaS50eXBlLAogICAgICAgICAgICAgICAgICBwYXljb2RlOiBpLnBheWNvZGUsCiAgICAgICAgICAgICAgICAgIHN0b3JlcmVwbHk6IGkuc3RvcmVyZXBseSwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGFycltpLmNvZGVdLmdvb2RzLnB1c2goaSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgT2JqZWN0LnZhbHVlcyhhcnIpLmZvckVhY2goKGkpID0+IHsKICAgICAgICAgICAgICBsaXN0LnB1c2goaSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgbGV0IHNvcnRBcnIgPSBsaXN0LnNvcnQoKGEsIGIpID0+IHsKICAgICAgICAgICAgICByZXR1cm4gYi5pZCAtIGEuaWQ7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBsaXN0ID0gc29ydEFycjsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuc2hvcHBpbmdjYXJ0TGlzdCA9IGxpc3Q7CiAgICAgICAgfSk7CiAgICB9LAoKICAgIC8vIOaUr+S7mAogICAgcGF5KGl0ZW0pIHsKICAgICAgYXBpCiAgICAgICAgLmNoYW5nZXN0YXR1cyh7CiAgICAgICAgICBjb2RlOiBpdGVtLmNvZGUsCiAgICAgICAgICBzdGF0dXM6ICLlvoXmoLjplIAiLAogICAgICAgIH0pCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgaWYgKHJlcy5jb2RlID09IDIwMCkgewogICAgICAgICAgICB0aGlzLiR0b2FzdCgi5pSv5LuY5oiQ5YqfISIpOwogICAgICAgICAgICB0aGlzLmdldERhdGEoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCgogICAgLy8g5Y+N6aaICiAgICByZXBseSgpIHsKICAgICAgaWYgKHRoaXMucmVwbHljb250ZW50ID09ICIiKSB7CiAgICAgICAgdGhpcy4kdG9hc3QoIuWPjemmiOS4uuepuiEiKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgYXBpCiAgICAgICAgLmNoYW5nZXN0YXR1cyh7CiAgICAgICAgICBjb2RlOiB0aGlzLmNvZGUsCiAgICAgICAgICByZXBseTogdGhpcy5yZXBseWNvbnRlbnQsCiAgICAgICAgICBzdGF0dXM6ICLlt7LlrozmiJAiLAogICAgICAgIH0pCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgaWYgKHJlcy5jb2RlID09IDIwMCkgewogICAgICAgICAgICB0aGlzLiR0b2FzdCgi5Y+N6aaI5oiQ5YqfISIpOwogICAgICAgICAgICB0aGlzLmdldERhdGEoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCgogICAgLy8g5qC46ZSACiAgICB2ZXJpZmljYXRpb24oaXRlbSkgewogICAgICBhcGkKICAgICAgICAuY2hhbmdlc3RhdHVzKHsKICAgICAgICAgIGNvZGU6IGl0ZW0uY29kZSwKICAgICAgICAgIHN0YXR1czogIuW3suaguOmUgCIsCiAgICAgICAgfSkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICBpZiAocmVzLmNvZGUgPT0gMjAwKSB7CiAgICAgICAgICAgIHRoaXMuJHRvYXN0KCLmoLjplIDmiJDlip8hIik7CiAgICAgICAgICAgIHRoaXMuZ2V0RGF0YSgpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICB9LAogIGNvbXB1dGVkOiB7CiAgICBzdW1QcmljZSgpIHsKICAgICAgcmV0dXJuIChyb3dzKSA9PiB7CiAgICAgICAgbGV0IHRvdGFsID0gMDsKICAgICAgICByb3dzLmZvckVhY2goKGkpID0+IHsKICAgICAgICAgIHRvdGFsICs9IE51bWJlcihjYWxjdWxhdGUuY2hlbmcoTnVtYmVyKGkubnVtKSwgTnVtYmVyKGkucHJpY2UpKSk7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHRoaXMuJHRvb2wucm91bmQodG90YWwsIDIpOwogICAgICB9OwogICAgfSwKICB9LAogIHdhdGNoOiB7fSwKfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2EA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/shoppingCart","sourcesContent":["<template>\n  <div class=\"shopping-container\">\n    <div class=\"commodity-head\">\n      <van-nav-bar left-arrow @click-left=\"$router.back()\" title=\"订单\" />\n    </div>\n    <van-sticky>\n      <van-tabs v-model=\"active\" color=\"rgb(102, 161, 136)\" @change=\"getData\">\n        <van-tab title=\"全部\" name=\"\"></van-tab>\n        <van-tab title=\"待付款\" name=\"待付款\"></van-tab>\n        <van-tab title=\"待核销\" name=\"待核销\"></van-tab>\n        <van-tab title=\"待反馈\" name=\"已核销\"></van-tab>\n        <van-tab title=\"已完成\" name=\"已完成\"></van-tab>\n      </van-tabs>\n    </van-sticky>\n    <div class=\"home-search\">\n      <van-search v-model=\"value\" placeholder=\"请输入订单号搜索订单\" icon-prefix=\"iconfont\" left-icon=\"iconfont icon-search\" @input=\"getData\" />\n    </div>\n    <!-- <div class=\"gradual-change\"></div> -->\n    <div class=\"shoppingcart-list\">\n      <ul>\n        <li class=\"shopping-cart\" v-for=\"(shoppingcart, sindex) in shoppingcartList\" :key=\"sindex\">\n          <div class=\"shoppingcart-head\" @click=\"$router.push('/commodity?id=' + shoppingcart.sid)\">\n            <p class=\"shop-name\">{{ shoppingcart.sname }}</p>\n            <p class=\"iconfont icon-arrow-right\"></p>\n          </div>\n          <p style=\"padding: 0 15px 15px 15px; color: rgb(102, 161, 136)\" class=\"f-r f-a-c f-j-s\">\n            <span>订单号: {{ shoppingcart.code }}</span>\n            <span class=\"font13\">{{ shoppingcart.type }}</span>\n          </p>\n          <div class=\"shoppingcart-body\">\n            <ul>\n              <li class=\"order-list\" v-for=\"(order, oindex) in shoppingcart.goods\" :key=\"oindex\">\n                <img :src=\"order.img\" alt=\"\" />\n                <div class=\"order-right\">\n                  <p class=\"order-name font-hidden\" style=\"width: 130px\">{{ order.name }}</p>\n                  <p class=\"order-price\">￥{{ order.price }}</p>\n                  <p class=\"order-share\">× {{ order.num }}</p>\n                </div>\n              </li>\n            </ul>\n            <div class=\"order-sum-price mb20\" v-if=\"shoppingcart.status=='待核销'\">\n              <span class=\"pt10 pb10 font18 font-default f-r f-a-c f-j-s\">\n                <span>核销码:{{ shoppingcart.paycode }}</span>\n                <van-button type=\"primary\" size=\"small\" color=\"rgb(102, 161, 136)\" v-show=\"shoppingcart.status == '待核销'\" @click=\"$router.push(`/location?code=${shoppingcart.code}`)\">骑手位置</van-button>\n              </span>\n            </div>\n            <div class=\" order-sum-price\">\n              <span class=\"order-p\">小计</span>\n              <span class=\"order-span\">￥</span>\n              <span class=\"order-total\">{{ sumPrice(shoppingcart.goods) }}</span>\n            </div>\n          </div>\n          <div class=\"button\">\n            <van-button class=\"button1\" type=\"primary\" size=\"small\" color=\"rgb(102, 161, 136)\" v-show=\"shoppingcart.status == '待付款'\" @click=\"pay(shoppingcart)\">立即支付</van-button>\n            <van-button class=\"button1\" type=\"primary\" size=\"small\" color=\"rgb(102, 161, 136)\" v-show=\"shoppingcart.status == '已核销'\" @click=\"\n                code = shoppingcart.code;\n                show = true;\n              \">反馈</van-button>\n            <van-button class=\"button1\" type=\"primary\" size=\"small\" color=\"rgb(102, 161, 136)\" v-show=\"shoppingcart.status == '待核销' && shoppingcart.type == '外卖配送'\" @click=\"verification(shoppingcart)\">核销</van-button>\n            <div v-show=\"shoppingcart.status == '待核销' && shoppingcart.type == '店内就餐'\" style=\"color:rgb(102, 161, 136)\" class=\"pt10 pr20 pb10\">待核销</div>\n            <div v-show=\"shoppingcart.storereply\" class=\"font-default pr20 pl20 pt10\">商家回复:{{shoppingcart.storereply}}</div>\n            <div v-show=\"shoppingcart.status == '已完成'\" class=\"font-default p20\">已完成</div>\n          </div>\n        </li>\n      </ul>\n    </div>\n\n    <!-- 反馈 -->\n    <van-dialog v-model=\"show\" title=\"反馈\" show-cancel-button confirmButtonColor=\"rgb(102, 161, 136)\" @close=\"replycontent = ''\" @confirm=\"reply\">\n      <van-field v-model=\"replycontent\" rows=\"4\" autosize label=\"\" type=\"textarea\" placeholder=\"请输入反馈\" />\n    </van-dialog>\n  </div>\n</template>\n\n<script>\nimport * as api from \"@/api/api\";\nimport calculate from \"@/utils/calculate\";\n\nexport default {\n  name: \"ShoppingIndex\",\n  data() {\n    return {\n      value: \"\",\n      show: false,\n      active: \"\",\n      replycontent: \"\",\n      code: \"\",\n      shoppingcartList: [],\n    };\n  },\n  created() {\n    if (!sessionStorage.getItem(\"id\")) {\n      this.$toast(\"请先登录\");\n      this.$router.push(\"/my\");\n      return;\n    }\n    this.getData();\n  },\n  methods: {\n    getData() {\n      api\n        .orderslist({\n          limit: 999,\n          offset: 1,\n          code: this.value,\n          status: this.active,\n          uid: sessionStorage.getItem(\"id\"),\n        })\n        .then((res) => {\n          let list = [];\n          if (res.data.total > 0) {\n            let arr = {};\n            res.data.list.forEach((i) => {\n              if (!arr[i.code]) {\n                arr[i.code] = {\n                  id: i.id,\n                  code: i.code,\n                  sname: i.sname,\n                  simg: i.simg,\n                  sid: i.sid,\n                  time: i.time,\n                  goods: [i],\n                  status: i.status,\n                  type: i.type,\n                  paycode: i.paycode,\n                  storereply: i.storereply,\n                };\n              } else {\n                arr[i.code].goods.push(i);\n              }\n            });\n            Object.values(arr).forEach((i) => {\n              list.push(i);\n            });\n\n            let sortArr = list.sort((a, b) => {\n              return b.id - a.id;\n            });\n            list = sortArr;\n          }\n          this.shoppingcartList = list;\n        });\n    },\n\n    // 支付\n    pay(item) {\n      api\n        .changestatus({\n          code: item.code,\n          status: \"待核销\",\n        })\n        .then((res) => {\n          if (res.code == 200) {\n            this.$toast(\"支付成功!\");\n            this.getData();\n          }\n        });\n    },\n\n    // 反馈\n    reply() {\n      if (this.replycontent == \"\") {\n        this.$toast(\"反馈为空!\");\n        return;\n      }\n      api\n        .changestatus({\n          code: this.code,\n          reply: this.replycontent,\n          status: \"已完成\",\n        })\n        .then((res) => {\n          if (res.code == 200) {\n            this.$toast(\"反馈成功!\");\n            this.getData();\n          }\n        });\n    },\n\n    // 核销\n    verification(item) {\n      api\n        .changestatus({\n          code: item.code,\n          status: \"已核销\",\n        })\n        .then((res) => {\n          if (res.code == 200) {\n            this.$toast(\"核销成功!\");\n            this.getData();\n          }\n        });\n    },\n  },\n  computed: {\n    sumPrice() {\n      return (rows) => {\n        let total = 0;\n        rows.forEach((i) => {\n          total += Number(calculate.cheng(Number(i.num), Number(i.price)));\n        });\n        return this.$tool.round(total, 2);\n      };\n    },\n  },\n  watch: {},\n};\n</script>\n\n<style scoped lang=\"less\">\n.shopping-container {\n  padding-bottom: 95px;\n}\n.commodity-head /deep/ .van-nav-bar__content {\n  background-color: rgb(102, 161, 136);\n  height: 70px;\n  line-height: 50px;\n}\n.commodity-head /deep/ .van-nav-bar__title {\n  font-size: 20px;\n  font-weight: 600;\n}\n.commodity-head /deep/ .van-icon-arrow-left::before {\n  font-size: 20px;\n  font-weight: 600;\n  //   margin-top: -160px;\n  color: #000;\n}\n.gradual-change {\n  width: 100%;\n  height: 300px;\n  background-image: linear-gradient(\n    rgb(102, 161, 136),\n    rgb(102, 161, 136),\n    #b8d9c6,\n    #b8d9c6,\n    #fff\n  );\n  margin-top: -1px;\n}\n.home-search {\n  padding: 8px 21px 5px 28px;\n}\n.home-search /deep/ .van-search {\n  width: 320px;\n}\n.home-search /deep/ .van-search__content {\n  width: 320px;\n  height: 40px;\n  line-height: 50px;\n  padding-top: 8px;\n  padding-left: 15px;\n  border-radius: 12px;\n  box-shadow: 0 0 5px 2px rgb(216, 216, 216);\n  background: #fff;\n}\n.home-search /deep/ .icon-search:before {\n  font-size: 20px;\n  font-weight: 700;\n  color: rgb(102, 161, 136);\n}\n.home-search /deep/ .van-field__control {\n  padding-left: 15px;\n  font-size: 16px;\n}\n.home-search /deep/ .van-field__clear {\n  font-size: 20px;\n  // font-weight: 600;\n  color: rgb(102, 161, 136);\n}\n.shopping-cart {\n  // position: absolute;\n  // top: 80px;\n  // left: 17px;\n  width: 340px;\n  // height: 500px;\n  background-color: #fff;\n  border-radius: 15px;\n  box-shadow: 0 1px 5px 2px rgb(216, 216, 216);\n  margin: 8px 0 0 17px;\n}\n.shoppingcart-head {\n  height: 70px;\n  line-height: 70px;\n}\n.shop-name {\n  font-size: 20px;\n  font-weight: 600;\n  padding: 0px 15px;\n  float: left;\n}\n.icon-arrow-right {\n  float: left;\n  font-size: 20px;\n  font-weight: 600;\n  color: rgb(102, 161, 136);\n}\n.shoppingcart-body {\n  // height: 100px;\n  padding-left: 10px;\n  // background-color: green;\n}\n.order-list {\n  display: flex;\n  width: 320px;\n  height: 80px;\n  // background-color: pink;\n  padding-bottom: 2px;\n}\n.order-list > img {\n  width: 76px;\n  height: 76px;\n  border-radius: 5px;\n  margin: 2px;\n}\n.order-right {\n  margin-left: 0px;\n  padding-left: 15px;\n  margin-top: 5px;\n}\n.order-name {\n  width: 150px;\n  font-size: 18px;\n  font-weight: 600;\n  float: left;\n  // margin-right: 40px;\n}\n.order-price {\n  float: left;\n  font-size: 20px;\n  font-weight: 600;\n}\n.order-share {\n  padding-top: 45px;\n}\n.order-sum-price {\n  text-align: right;\n  padding-top: 15px;\n  padding-right: 20px;\n}\n.order-p {\n  margin-left: 190px;\n  // float: left;\n  font-size: 15px;\n  margin-right: 10px;\n}\n.order-span {\n  font-size: 13px;\n  font-weight: 600;\n}\n.order-total {\n  // float: left;\n  font-size: 22px;\n  font-weight: 600;\n}\n.button {\n  text-align: right;\n}\n.button1 {\n  border-radius: 5px !important;\n  margin: 12px 15px;\n}\n</style>\n"]}]}